{
    "contents" : "VPJ41086<- 30000\nVPJ41086K<-1\nVPJ41086Z<-2\n#install.packages(\"BBmisc\")\n#library(BBBmisc)\nstring <- \"VTJ41003' +IF(VPJ41086 <= -5000, 'A' , if(VPJ41086 > -5000 && VPJ41086 <= 0, 'B', if (VPJ41086 > 0 && VPJ41086 <= 5000, 'C', If (VPJ41086 > 5000 && VPJ41086 <= 10000, 'D', if (VPJ41086 > 10000 && VPJ41086 <= 15000, 'E', if(VPJ41086 > 15000 && VPJ41086 <= 20000, 'F', if(VPJ41086 > 20000 && VPJ41086 <= 25000, 'G', if(VPJ41086 > 25000 && VPJ41086 <= 30000, 'H', if(VPJ41086 > 30000 && VPJ41086 <= 35000, 'I', if (VPJ41086 > 35000 && VPJ41086 <= 40000, 'J', if (VPJ41086 > 40000 && VPJ41086 <= 50000, 'K', 'Z')))))))))))\"\n#eval(parse(text=string))\n#syntex <- \"IF(VPJ41086 <= -5000\"\n#ifclause <- trimws(paste0(gsub(\"if|IF|IF\\\\(|If|iF\",\"if( \",syntex ),\")\"))\n\nproblem1 <- function(string){\n\n#gsub(\"^IF\", \"if\", string)\n#install.packages(\"stringr\")\nlibrary(stringr)\nstring1 <- strsplit(string, \"\\\\+\")[[1]][1]\nstring2 <- strsplit(string, \"\\\\+\")[[1]][2]\nstring3 <- gsub(\"[\\\\(\\\\)]\", \"\", regmatches(string2, gregexpr(\"\\\\(.*?\\\\)\", string2)))\n\nstring4 <- strsplit(string3,\",\")[[1]]\nvarible<- word(string4, 1)\nvarible[1]\n#regmatches(string2, gregexpr(\"(?=\\\\().*?(?<=\\\\))\", string2, perl=T))\n\nwhile(length(string4) >= 3){\n  \nlastPart <- tail(string4,3)\n\nifclause <- trimws(paste0(gsub(\"if|IF|IF\\\\(|If|iF|if\\\\(|If\\\\(|iF\\\\(|^if\",\"if( \",lastPart[1]) ,\")\"))\nclass(ifclause)\n#if(nchar(word(ifclause, 2),type=\"width\") > 3 ){\n \n# print(nchar(word(ifclause, 2),type=\"width\"))\n # varible<- word(ifclause, 2)\n#}else {\n \n#}\n\n#print(varible)\n#print(lastPart[3])\nif(nchar(trimws(gsub(\"'\",\"\",lastPart[3])),type=\"width\") < 3){\n  \nlastSyntex <- paste0(ifclause,\"{ \",varible[1],trimws(gsub(\"'\",\"\",lastPart[2])),\" } \",\"else { \",varible[1],trimws(gsub(\"'\",\"\",lastPart[3])),\" }\")\n}else{\nlastSyntex <- paste0(ifclause,\"{ \",varible[1],trimws(gsub(\"'\",\"\",lastPart[2])),\" } \",\"else { \",trimws(lastPart[3]),\" }\")\n}\n\n\nstring4 <- append(head(string4,-3),lastSyntex)\n#print(string4)\n}\n\nstring5 <- paste0(gsub(\"'\",\"\",string1),\" + \",\"if( \",string4)\nreturn (string5)\n\n}\n#problem1(string)\n\n#is.error(eval(parse(text=problem1(string))))\n######## problem 2 \n\nstring <- \"IF(VAJ41177<0,VAJ41177,0)+IF(VAJ41178<0,VAJ41178,0)+IF(VAJ41179<0,VAJ41179,0)+IF(VAJ41180<0,VAJ41180,0)+IF(VAJ41181<0,VAJ41181,0)\"\n#gsub(\"IF\\\\(\",\"if(\",\"IF(VAJ41177<0\")\n\nproblem2 <- function(string){\n  \n  library(stringr)\n\n  string1 <- gsub(\"\\\\+| + \",\",\",string)\n  string4 <- strsplit(string1,\",\")[[1]]\n  #varible<- word(string4, 1)\n  #varible[1]\n  #regmatches(string2, gregexpr(\"(?=\\\\().*?(?<=\\\\))\", string2, perl=T))\n  \n  while(length(string4) >= 3){\n    \n    lastPart <- tail(string4,3)\n    \n    #ifclause <- trimws(paste0(gsub(\"if|IF|IF\\\\(|If|iF|if\\\\(|If\\\\(|iF\\\\(|^if|^IF|IF\\\\(\",\"if( \",lastPart[1]) ,\" )\"))\n    ifclause <- trimws(paste0(gsub(\"IF\\\\(\",\"if( \",lastPart[1]) ,\" )\"))\n    lastPart[3]<- gsub(\"0\\\\)\",0,lastPart[3])\n    \n    #if(nchar(word(ifclause, 2),type=\"width\") > 3 ){\n    \n    # print(nchar(word(ifclause, 2),type=\"width\"))\n    # varible<- word(ifclause, 2)\n    #}else {\n    \n    #}\n    \n    #print(varible)\n    #print(lastPart[3])\n    if(nchar(trimws(gsub(\"'\",\"\",lastPart[3])),type=\"width\") < 3){\n      \n      lastSyntex <- paste0(ifclause,\"{ \",trimws(gsub(\"'\",\"\",lastPart[2])),\" } \",\"else { \",trimws(gsub(\"'\",\"\",lastPart[3])),\" }\")\n    }else{\n      lastSyntex <- paste0(ifclause,\"{ \",trimws(gsub(\"'\",\"\",lastPart[2])),\" } \",\"else { \",trimws(lastPart[3]),\" }\")\n    }\n    \n    \n    string4 <- append(head(string4,-3),lastSyntex)\n    string4 <- gsub(\"IF\\\\(\",\"if(\",string4)\n    #print(string4)\n  }\n  \n  \n  return (string4)\n  \n}\n#problem2(string)\n\n\n#######end \n\n######## problem three\n\nstring <- \"YZSI4310(PQ1)+YZSI4310(PQ2)+YZSI4310(PQ3)+YZSI4310(PQ4)\"\n\nproblem3 <- function(string){\nstring1 <- strsplit(string, \"\\\\+\")[[1]]\nstring2 <- data.frame(strsplit(string1, \"\\\\(\")) \n\nstring4 <- gsub(\"\\\\)\", \"\", as.matrix(string2[,-1]))\n\nreturn(string4)\n}\n#problem3(string)\n\n#####end\n#error function\n\nis.error.element <- function(x){\n  testError   <- inherits(x, \"error\")\n  if(testError == TRUE){\n    testSimple  <- inherits(x, \"simpleError\")\n    errMsg      <- x$message\n  } else {\n    testSimple  <- FALSE\n    errMsg      <- NA\n  }\n  return(data.frame(testError, testSimple, errMsg, stringsAsFactors = FALSE))\n}\n\nis.error <- function(testObject){\n  quickTest <- is.error.element(testObject)\n  if(quickTest$testError == TRUE){\n    return(quickTest)\n  } else {\n    return(lapply(testObject, is.error.element))\n  }\n}\n\n\n",
    "created" : 1456908557668.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "638143476",
    "id" : "39F5FDFC",
    "lastKnownWriteTime" : 1456941766,
    "path" : "~/Documents/R_workshop/txtAdujstment/parserFunctions.R",
    "project_path" : "parserFunctions.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}